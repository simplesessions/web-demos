---
const PASSWORD = 'refinery';
const STORAGE_KEY = 'ss-auth';
---

<div id="password-gate" class="fixed inset-0 z-50 flex items-center justify-center bg-zinc-950">
  <form id="password-form" class="mx-4 w-full max-w-sm rounded-2xl border border-zinc-700 bg-zinc-900 px-8 py-10">
    <label for="password-input" class="block text-sm font-medium text-zinc-400 mb-2">
      Enter password
    </label>
    <input
      id="password-input"
      type="password"
      autocomplete="current-password"
      class="w-full rounded-lg border border-zinc-600 bg-zinc-800 px-4 py-3 text-zinc-100 placeholder-zinc-500 focus:border-zinc-500 focus:outline-none focus:ring-1 focus:ring-zinc-500"
      placeholder="Password"
    />
    <p id="password-error" class="mt-2 text-sm text-red-500 hidden">Wrong password</p>
    <button
      type="submit"
      class="mt-4 w-full rounded-lg bg-zinc-700 py-2.5 font-medium text-zinc-100 hover:bg-zinc-600 transition-colors"
    >
      Enter
    </button>
  </form>
</div>

<script define:vars={{ PASSWORD, STORAGE_KEY }}>
  const gate = document.getElementById('password-gate');
  const form = document.getElementById('password-form');
  const input = document.getElementById('password-input');
  const error = document.getElementById('password-error');

  if (sessionStorage.getItem(STORAGE_KEY) === '1') {
    gate?.remove();
  } else {
    form?.addEventListener('submit', (e) => {
      e.preventDefault();
      if (input?.value === PASSWORD) {
        sessionStorage.setItem(STORAGE_KEY, '1');
        gate?.remove();
      } else {
        error?.classList.remove('hidden');
      }
    });
  }
</script>
